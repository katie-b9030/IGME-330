(()=>{"use strict";var e,t,n,o,a,r,c,i,l,u,s,h,d,g,f,v,m,y=!1,p=!1,w=!1,S=20,T=Object.freeze({gain:.5,numSamples:256}),b=(new Uint8Array(T.numSamples/2),function(e){t.src=e}),q=function(e){void 0===e&&(e=20);for(var t=new Float32Array(256),n=0;n<256;++n){var o=2*n/256-1;t[n]=(Math.PI+e)*o/(Math.PI+e*Math.abs(o))}return t},P=function(){function e(e,t,n,o){this.x=e,this.y=t,this.centerRadius=n,this.audioData=o,this.length=o.length,this.scale=1}return e.prototype.update=function(e){this.audioData=e},e.prototype.draw=function(e){e.save(),e.translate(this.x,this.y);var t=this.audioData[this.length/2]/100;t<1&&(t=1),e.scale(t,t);for(var n=0;n<8;n++)M(e,2*this.centerRadius,n*Math.PI/4,"#FFBF00");for(n=0;n<8;n++)M(e,2*this.centerRadius,Math.PI/8+n*Math.PI/4,"#FFCF40");e.fillStyle="#3D2314",e.beginPath(),e.arc(0,0,this.centerRadius,0,2*Math.PI),e.closePath(),e.fill(),e.fillStyle="#23120B",e.beginPath(),e.arc(0,0,.66*this.centerRadius,0,2*Math.PI),e.closePath(),e.fill(),e.restore()},e}(),M=function(e,t,n,o){e.save(),e.rotate(n),e.fillStyle=o,e.beginPath(),e.moveTo(0,0),e.lineTo(-t/8,0),e.lineTo(-t/8,.66*-t),e.lineTo(0,-t),e.lineTo(t/8,.66*-t),e.lineTo(t/8,0),e.closePath(),e.fill(),e.restore()},k=!0,A={showGradient:!0,showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,showEmboss:!1},I=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),F=function(){var y,p,w;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((w=function(){return 185*Math.random()+35})(),",").concat(w(),",").concat(w(),",1)"))),y=I.sound1,p=window.AudioContext,e=new p,t=new Audio,b(y),n=e.createMediaElementSource(t),(o=e.createBiquadFilter()).type="highshelf",(a=e.createBiquadFilter()).type="highshelf",r=e.createWaveShaper(),(c=e.createAnalyser()).fftSize=T.numSamples,(i=e.createGain()).gain.value=T.gain,n.connect(o),o.connect(a),a.connect(r),r.connect(c),c.connect(i),i.connect(e.destination);var S=document.querySelector("canvas");N(S),function(e,t){l=e.getContext("2d"),u=e.width,s=e.height,h=function(e,t,n,o,a,r){for(var c=e.createLinearGradient(0,0,0,a),i=0,l=[{percent:0,color:"hotPink"},{percent:.25,color:"paleVioletRed"},{percent:.5,color:"lightPink"},{percent:.75,color:"orange"},{percent:1,color:"gold"}];i<l.length;i++){var u=l[i];c.addColorStop(u.percent,u.color)}return c}(l,0,0,0,s),d=t,g=new Uint8Array(d.fftSize/2),f=new P(u/2,s/2,50,g),v=new P(u/5,.75*s,35,g),m=new P(.8*u,s/3,20,g)}(S,c),C(),B()},N=function(n){var c=document.querySelector("#btn-fs"),l=document.querySelector("#btn-play");c.onclick=function(){var e;console.log("goFullscreen() called"),(e=n).requestFullscreen&&e.requestFullscreen()},l.onclick=function(n){var o=n.target;console.log("audioCtx.state before = ".concat(e.state)),"suspended"==e.state&&e.resume(),console.log("audioCtx.state after = ".concat(e.state)),"no"==o.dataset.playing?(t.play(),o.dataset.playing="yes"):(t.pause(),o.dataset.playing="no");var a=document.querySelector("#cb-gradient"),r=document.querySelector("#cb-bars"),c=document.querySelector("#cb-noise"),i=document.querySelector("#cb-invert"),l=document.querySelector("#cb-emboss");a.onchange=function(){a.checked?A.showGradient=!0:A.showGradient=!1},r.onchange=function(){r.checked?A.showBars=!0:A.showBars=!1},c.onchange=function(){c.checked?A.showNoise=!0:A.showNoise=!1},i.onchange=function(){i.checked?A.showInvert=!0:A.showInvert=!1},l.onchange=function(){l.checked?A.showEmboss=!0:A.showEmboss=!1}};var u=document.querySelector("#slider-volume"),s=document.querySelector("#label-volume");u.oninput=function(e){var t,n=e.target;t=Number(n.value),t=Number(t),i.gain.value=t,s.innerHTML=Math.round(Number(n.value)/2*100).toString()},u.dispatchEvent(new Event("input")),document.querySelector("#select-track").onchange=function(e){var t=e.target;b(t.value),"yes"==l.dataset.playing&&l.dispatchEvent(new MouseEvent("click"))},document.querySelector("#select-vizualizer").onchange=function(){k=!k};var h=document.querySelector("#cb-highshelf"),d=document.querySelector("#cb-lowshelf"),g=document.querySelector("#slider-distortion"),f=document.querySelector("#cb-distortion");h.checked=y,h.onchange=function(){(y=!y)?(o.frequency.setValueAtTime(1e3,e.currentTime),o.gain.setValueAtTime(25,e.currentTime)):o.gain.setValueAtTime(0,e.currentTime)},d.checked=p,d.onchange=function(){(p=!p)?(a.frequency.setValueAtTime(1e3,e.currentTime),a.gain.setValueAtTime(15,e.currentTime)):a.gain.setValueAtTime(0,e.currentTime)},g.value=S.toString(),g.onchange=function(e){var t,n=e.target;t=Number(n.value),S=t,w?(r.curve=null,r.curve=q(S)):r.curve=null},f.value=S.toString(),f.onchange=function(){(w=!w)?(r.curve=null,r.curve=q(S)):r.curve=null}},B=function(){setTimeout(B,1e3/60),function(e){if(k?d.getByteFrequencyData(g):d.getByteTimeDomainData(g),l.save(),l.fillStyle="black",l.globalAlpha=.9,l.fillRect(0,0,u,s),l.restore(),e.showGradient&&(l.save(),l.fillStyle=h,l.globalAlpha=.3,l.fillRect(0,0,u,s),l.restore()),e.showBars){var t=(u-150-20)/21;l.save(),l.fillStyle="rgba(55, 150, 55, 0.50)",l.strokeStyle="rgba(0, 0, 0, 0.50)",l.translate(10,s/2);for(var n=0;n<g.length;n+=g.length/16){var o=g[n]/25;o<1&&(o=1),l.beginPath(),l.moveTo(0,0),l.lineTo(0,20*o/2),l.lineTo(t,20*o/2),l.lineTo(t,-20*o/2),l.lineTo(0,-20*o/2),l.closePath(),l.fill(),l.translate(20+t,0)}l.restore()}f.update(g),f.draw(l),v.update(g),v.draw(l),m.update(g),m.draw(l);var a=l.getImageData(0,0,u,s),r=a.data,c=r.length,i=a.width;for(n=0;n<c;n+=4)if(e.showNoise&&Math.random()<.05&&(r[n]=r[n+1]=r[n+2]=0,r[n+1]=r[n+2]=125),e.showInvert){var y=r[n],p=r[n+1],w=r[n+2];r[n]=255-y,r[n+1]=255-p,r[n+2]=255-w}if(e.showEmboss)for(n=0;n<c;n++)n%4!=3&&(r[n]=127+2*r[n]-r[n+4]-r[n+4*i]);l.putImageData(a,0,0)}(A)},C=function(){var e=new XMLHttpRequest;e.onload=function(e){var t=e.target;console.log("In onload - HTTP Status Code = ".concat(t.status));var n=t.responseText,o=JSON.parse(n),a=o.title,r=o["track-files"],c=o["track-names"],i=o.instructions,l="".concat(a.map((function(e){return"".concat(e)})).join("")),u="<p>".concat(i.map((function(e){return"".concat(e,"<br>")})).join(""),"</p>");document.querySelector(".title").innerHTML=l,document.querySelector(".subtitle").innerHTML=u;var s=document.querySelector("#select-track"),h=s.querySelector("#NAT"),d=s.querySelector("#PT"),g=s.querySelector("#TPS");h.value=r[0],h.innerHTML=c[0],d.value=r[1],d.innerHTML=c[1],g.value=r[2],g.innerHTML=c[2]},e.onerror=function(e){var t=e.target;console.log("In onerror - HTTP Status Code = ".concat(t.status))},e.open("GET","./data/av-data.json"),e.send()};window.onload=function(){console.log("window.onload called"),F()}})();
//# sourceMappingURL=bundle.js.map