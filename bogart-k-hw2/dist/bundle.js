(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var t,n,o,r,a,c,i,l,u=!1,s=!1,f=!1,d=20,h=Object.freeze({gain:.5,numSamples:256}),m=(new Uint8Array(h.numSamples/2),function(e){n.src=e}),y=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=new Float32Array(256),n=0;n<256;++n){var o=2*n/256-1;t[n]=(Math.PI+e)*o/(Math.PI+e*Math.abs(o))}return t};function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,b(o.key),o)}}function b(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=v(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var p,w,S,T,q,P,k,A,M,F=function(){return e=function e(t,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.centerRadius=o,this.audioData=this.audioData,this.length=r.length,this.scale=1},t=[{key:"update",value:function(e){this.audioData=e}},{key:"draw",value:function(e){e.save(),e.translate(this.x,this.y);var t=this.audioData[this.length/2]/100;t<1&&(t=1),e.scale(t,t);for(var n=0;n<8;n++)I(e,2*this.centerRadius,n*Math.PI/4,"#FFBF00");for(var o=0;o<8;o++)I(e,2*this.centerRadius,Math.PI/8+o*Math.PI/4,"#FFCF40");e.fillStyle="#3D2314",e.beginPath(),e.arc(0,0,this.centerRadius,0,2*Math.PI),e.closePath(),e.fill(),e.fillStyle="#23120B",e.beginPath(),e.arc(0,0,.66*this.centerRadius,0,2*Math.PI),e.closePath(),e.fill(),e.restore()}}],t&&g(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),I=function(e,t,n,o){e.save(),e.rotate(n),e.fillStyle=o,e.beginPath(),e.moveTo(0,0),e.lineTo(-t/8,0),e.lineTo(-t/8,.66*-t),e.lineTo(0,-t),e.lineTo(t/8,.66*-t),e.lineTo(t/8,0),e.closePath(),e.fill(),e.restore()},R=!0,C=function(t,n){p=t.getContext("2d"),w=t.width,S=t.height,T=function(t,n,o,r,a,c){var i,l=t.createLinearGradient(0,0,0,a),u=function(t,n){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function(t,n){if(t){if("string"==typeof t)return e(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){o&&(t=o);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,l=!1;return{s:function(){o=o.call(t)},n:function(){var e=o.next();return i=e.done,e},e:function(e){l=!0,c=e},f:function(){try{i||null==o.return||o.return()}finally{if(l)throw c}}}}([{percent:0,color:"hotPink"},{percent:.25,color:"paleVioletRed"},{percent:.5,color:"lightPink"},{percent:.75,color:"orange"},{percent:1,color:"gold"}]);try{for(u.s();!(i=u.n()).done;){var s=i.value;l.addColorStop(s.percent,s.color)}}catch(e){u.e(e)}finally{u.f()}return l}(p,0,0,0,S),q=n,P=new Uint8Array(q.fftSize/2),k=new F(w/2,S/2,50,P),A=new F(w/5,.75*S,35,P),M=new F(.8*w,S/3,20,P)},E={showGradient:!0,showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,showEmboss:!1},j=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),z=function(){var e,u,s;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((s=function(){return 185*Math.random()+35})(),",").concat(s(),",").concat(s(),",1)"))),e=j.sound1,u=window.AudioContext||window.webkitAudioContext,t=new u,n=new Audio,m(e),o=t.createMediaElementSource(n),(r=t.createBiquadFilter()).type="highshelf",(a=t.createBiquadFilter()).type="highshelf",c=t.createWaveShaper(),(i=t.createAnalyser()).fftSize=h.numSamples,(l=t.createGain()).gain.value=h.gain,o.connect(r),r.connect(a),a.connect(c),c.connect(i),i.connect(l),l.connect(t.destination);var f=document.querySelector("canvas");B(f),C(f,i),N(),D()},B=function(e){var o=document.querySelector("#btn-fs"),i=document.querySelector("#btn-play");o.onclick=function(t){var n;console.log("goFullscreen() called"),(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()},i.onclick=function(e){console.log("audioCtx.state before = ".concat(t.state)),"suspended"==t.state&&t.resume(),console.log("audioCtx.state after = ".concat(t.state)),"no"==e.target.dataset.playing?(n.play(),e.target.dataset.playing="yes"):(n.pause(),e.target.dataset.playing="no");var o=document.querySelector("#cb-gradient"),r=document.querySelector("#cb-bars"),a=document.querySelector("#cb-noise"),c=document.querySelector("#cb-invert"),i=document.querySelector("#cb-emboss");o.onchange=function(e){o.checked?E.showGradient=!0:E.showGradient=!1},r.onchange=function(e){r.checked?E.showBars=!0:E.showBars=!1},a.onchange=function(e){a.checked?E.showNoise=!0:E.showNoise=!1},c.onchange=function(e){c.checked?E.showInvert=!0:E.showInvert=!1},i.onchange=function(e){i.checked?E.showEmboss=!0:E.showEmboss=!1}};var h=document.querySelector("#slider-volume"),v=document.querySelector("#label-volume");h.oninput=function(e){var t;t=e.target.value,t=Number(t),l.gain.value=t,v.innerHTML=Math.round(e.target.value/2*100)},h.dispatchEvent(new Event("input")),document.querySelector("#select-track").onchange=function(e){m(e.target.value),"yes"==i.dataset.playing&&i.dispatchEvent(new MouseEvent("click"))},document.querySelector("#select-vizualizer").onchange=function(e){R=!R},document.querySelector("#cb-highshelf").checked=u,document.querySelector("#cb-highshelf").onchange=function(e){(u=!u)?(r.frequency.setValueAtTime(1e3,t.currentTime),r.gain.setValueAtTime(25,t.currentTime)):r.gain.setValueAtTime(0,t.currentTime)},document.querySelector("#cb-lowshelf").checked=s,document.querySelector("#cb-lowshelf").onchange=function(e){(s=!s)?(a.frequency.setValueAtTime(1e3,t.currentTime),a.gain.setValueAtTime(15,t.currentTime)):a.gain.setValueAtTime(0,t.currentTime)},document.querySelector("#slider-distortion").value=d,document.querySelector("#slider-distortion").onchange=function(e){var t;t=Number(e.target.value),d=t,f?(c.curve=null,c.curve=y(d)):c.curve=null},document.querySelector("#cb-distortion").value=d,document.querySelector("#cb-distortion").onchange=function(e){(f=!f)?(c.curve=null,c.curve=y(d)):c.curve=null}},D=function e(){setTimeout(e,1e3/60),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(R?q.getByteFrequencyData(P):q.getByteTimeDomainData(P),p.save(),p.fillStyle="black",p.globalAlpha=.9,p.fillRect(0,0,w,S),p.restore(),e.showGradient&&(p.save(),p.fillStyle=T,p.globalAlpha=.3,p.fillRect(0,0,w,S),p.restore()),e.showBars){var t=(w-150-20)/21;p.save(),p.fillStyle="rgba(55, 150, 55, 0.50)",p.strokeStyle="rgba(0, 0, 0, 0.50)",p.translate(10,S/2);for(var n=0;n<P.length;n+=P.length/16){var o=P[n]/25;o<1&&(o=1),p.beginPath(),p.moveTo(0,0,t,20*o),p.lineTo(0,20*o/2),p.lineTo(t,20*o/2),p.lineTo(t,-20*o/2),p.lineTo(0,-20*o/2),p.closePath(),p.fill(),p.translate(20+t,0)}p.restore()}k.update(P),k.draw(p),A.update(P),A.draw(p),M.update(P),M.draw(p);for(var r=p.getImageData(0,0,w,S),a=r.data,c=a.length,i=r.width,l=0;l<c;l+=4)if(e.showNoise&&Math.random()<.05&&(a[l]=a[l+1]=a[l+2]=0,a[l+1]=a[l+2]=125),e.showInvert){var u=a[l],s=a[l+1],f=a[l+2];a[l]=255-u,a[l+1]=255-s,a[l+2]=255-f}if(e.showEmboss)for(var d=0;d<c;d++)d%4!=3&&(a[d]=127+2*a[d]-a[d+4]-a[d+4*i]);p.putImageData(r,0,0)}(E)},N=function(){var e=new XMLHttpRequest;e.onload=function(e){console.log("In onload - HTTP Status Code = ".concat(e.target.status));var t=e.target.responseText,n=JSON.parse(t),o=n.title,r=n["track-files"],a=n["track-names"],c=n.instructions,i="<h1>".concat(o.map((function(e){return"".concat(e)})).join(""),"</h1>"),l="<p>".concat(c.map((function(e){return"".concat(e,"<br>")})).join(""),"</p>"),u="".concat(i).concat(l);document.querySelector("#info").innerHTML=u;var s=document.querySelector("#select-track");s.querySelector("#NAT").value=r[0],s.querySelector("#NAT").innerHTML=a[0],s.querySelector("#PT").value=r[1],s.querySelector("#PT").innerHTML=a[1],s.querySelector("#TPS").value=r[2],s.querySelector("#TPS").innerHTML=a[2]},e.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},e.open("GET","./data/av-data.json"),e.send()};window.onload=function(){console.log("window.onload called"),z()}})();